# AI 工具权限说明

本文介绍新版 AI 工具权限机制，帮助你快速理解「全局默认 + 单工具例外」的工作方式，并给出一些推荐用法。

---

## 一、权限模型概览

系统为 AI 工具提供了 4 种权限等级：

- **允许（ALLOW）**：直接执行，不再询问。
- **谨慎（CAUTION）**：只在判断为「可能有风险」的操作时弹窗确认，其他操作自动执行。
- **每次询问（ASK）**：每次调用前都弹窗询问。
- **禁止（FORBID）**：直接拒绝执行，不会调用该工具。

在此基础上，权限由两层共同决定：

1. **全局默认权限**：决定「所有工具的默认行为」。
2. **单工具例外配置**：对某个具体工具设置特殊规则，覆盖全局默认。

最终某个工具实际采用哪种权限等级，由下述规则决定。

---

## 二、全局默认权限

「全局默认权限」是整个系统的基础策略，适用于**所有没有单独配置的工具**。

你可以在设置页中，将全局默认设置为：

- **允许**：默认所有工具自动执行。
- **谨慎**：默认自动执行，只有被识别为「危险操作」的调用会弹窗确认。
- **每次询问**：默认所有工具调用前都弹窗。
- **禁止**：默认所有工具都被禁止执行。

> 只要某个工具没有配置「单工具例外」，它就会完全按照全局默认来执行。

---

## 三、单工具例外配置

在全局默认之外，你可以对个别工具设置「例外规则」。

在设置页中，每个权限分组（允许 / 谨慎 / 禁止）下，都可以手动添加工具：

- 把工具放进 **允许** 分组：代表「不管全局怎么设置，这个工具都允许自动执行」。
- 把工具放进 **谨慎** 分组：代表「这个工具采用谨慎策略」，即只有危险操作会弹窗。
- 把工具放进 **禁止** 分组：代表「这个工具始终禁止执行」。

当某个工具存在例外配置时：

> **实际权限 = 单工具例外等级**，而不是全局默认。

如果你想让某个工具**重新回到跟随全局默认**的状态，可以：

- 在分组中再次点击该工具，或
- 在工具选择对话框中取消勾选该工具。

此时，该工具的例外配置会被清除，重新根据全局默认执行。

---

## 四、推荐使用场景

下面是几个常见、易理解的权限组合示例：

### 场景 1：整体偏保守，只信任少数工具

- 全局默认：**每次询问（ASK）**
- 把你完全信任的只读/无副作用工具（如代码搜索、计算器等）加入 **允许（ALLOW）** 分组。

效果：

- 绝大多数工具在使用前都会弹窗确认；
- 只有你明确加入「允许」分组的工具会静默执行。

### 场景 2：整体偏自动，仅对高风险操作确认

- 全局默认：**谨慎（CAUTION）**
- 对于你感觉风险更高的工具（如修改文件、执行命令等），单独放入 **每次询问（ASK）** 或 **禁止（FORBID）** 分组。

效果：

- 普通读写、查询类工具会更自动；
- 真正敏感的工具仍然会被单独控制。

### 场景 3：极端安全模式，只允许少数白名单工具

- 全局默认：**禁止（FORBID）**
- 把你信任的工具按需要加入 **允许 / 谨慎 / 每次询问** 分组。

效果：

- 默认所有工具都被关掉；
- 只有你点名加入分组的工具才有机会被调用，且以你选择的权限级别执行。

---

## 五、小结

- 全局默认 = 底线策略，决定「没有例外时」所有工具的行为。
- 单工具例外 = 覆盖策略，让你可以对少数工具做更细粒度的控制。
- 没有出现在任何分组中的工具，一律视为「没有例外配置」，完全跟随全局默认。

如果你在配置过程中遇到不符合预期的行为，可以优先检查：

1. 全局默认当前设置为什么？
2. 该工具是否出现在某个分组中，被设置了例外规则？

根据这两个信息，基本可以判断出当前行为的原因。
